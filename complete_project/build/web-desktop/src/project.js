require=function e(t,i,n){function o(c,a){if(!i[c]){if(!t[c]){var r="function"==typeof require&&require;if(!a&&r)return r(c,!0);if(s)return s(c,!0);var u=new Error("Cannot find module '"+c+"'");throw u.code="MODULE_NOT_FOUND",u}var h=i[c]={exports:{}};t[c][0].call(h.exports,function(e){var i=t[c][1][e];return o(i||e)},h,h.exports,e,t,i,n)}return i[c].exports}for(var s="function"==typeof require&&require,c=0;c<n.length;c++)o(n[c]);return o}({Fire:[function(e,t,i){"use strict";cc._RF.push(t,"806561PGsxJVLUvCZG8IF8G","Fire"),cc.Class({extends:cc.Component,properties:{pickRadius:60,game:{default:null,serializable:!1},XSpeed:2},onLoad:function(){},getPlayerDistance:function(){var e=this.game.player.getPosition();return cc.pDistance(this.node.position,e)},onPicked:function(){this.game.gameOver()},update:function(e){this.getPlayerDistance()<this.pickRadius?this.onPicked():(this.node.getPosition().x<-cc.winSize.width/2&&(console.log("new fire"),this.game.spawnNewFire(),this.node.destroy()),this.node.x-=this.XSpeed*e)}}),cc._RF.pop()},{}],Game:[function(e,t,n){"use strict";cc._RF.push(t,"4e12fLSQu1L+KV6QmxDiavU","Game");var o=e("test");cc.Class({extends:cc.Component,properties:{starPrefab:{default:null,type:cc.Prefab},firePrefab:{default:null,type:cc.Prefab},maxStarDuration:0,minStarDuration:0,ground:{default:null,type:cc.Node},player:{default:null,type:cc.Node},test:{default:null,type:o},scoreDisplay:{default:null,type:cc.Label},scoreAudio:{default:null,url:cc.AudioClip},far_bg:[cc.Node],far_bg2:[cc.Node],fire_num:1,far_speed:.2,max_powerup_time:3},onLoad:function(){this.groundY=this.ground.y+this.ground.height,this.timer=0,this.starDuration=0,this.spawnNewStar(),this.spawnNewFire(),this.score=0,this.setInputControl(),this.fixBgPos(this.far_bg[0],this.far_bg[1]),this.fixBgPos(this.far_bg2[0],this.far_bg2[1])},fixBgPos:function(e,t){var i=e.getBoundingBox();console.log(t.getBoundingBox()),t.setPosition(i.xMax,i.yMin),console.log(e.getBoundingBox()),console.log(t.getBoundingBox())},bgMove:function(e,t,i){for(var n=0;n<e.length;n++)e[n].x-=t*i},checkBgReset:function(e){if(e[1].getBoundingBox().xMin<=-480){console.log("重置背景");var t=e.shift();e.push(t);var i=e[0];t.x=i.getBoundingBox().xMax}},spawnNewStar:function(){var e=cc.instantiate(this.starPrefab);this.node.addChild(e),e.setPosition(this.getNewStarPosition()),e.getComponent("Star").game=this,e.getComponent("Star").XSpeed=this.far_speed,this.starDuration=this.minStarDuration+cc.random0To1()*(this.maxStarDuration-this.minStarDuration),this.timer=0,this.starNow=e},getNewStarPosition:function(){var e=this.groundY+cc.random0To1()*this.player.getComponent("Player").jumpHeight+50,t=this.node.width/2;return cc.p(t,e)},spawnNewFire:function(){for(console.log("spawnFire"),console.log(this.node.getChildren().length),i=0;i<this.fire_num+8-this.node.getChildren().length;i++){var e=cc.instantiate(this.firePrefab);console.log(e.name),e.name="newFire",this.node.addChild(e),e.setPosition(this.getNewFirePosition()),e.getComponent("Fire").game=this,e.getComponent("Fire").XSpeed=this.far_speed}this.starDuration=this.minStarDuration+cc.random0To1()*(this.maxStarDuration-this.minStarDuration),this.timer=0},getNewFirePosition:function(){var e=this.groundY+cc.random0To1()*this.player.getComponent("Player").jumpHeight+30,t=this.node.width/2+cc.random0To1()*this.node.width/2;for(console.log(this.starNow);cc.pDistance(this.starNow.position,cc.p(t,e))<30;)e=this.groundY+cc.random0To1()*this.player.getComponent("Player").jumpHeight+30;return cc.p(t,e)},update:function(e){this.timer,this.starDuration,this.timer+=e,this.bgMove(this.far_bg,this.far_speed,e),this.bgMove(this.far_bg2,this.far_speed,e),this.checkBgReset(this.far_bg),this.checkBgReset(this.far_bg2)},gainScore:function(){this.score+=1,this.scoreDisplay.string="Score: "+this.score.toString(),cc.audioEngine.playEffect(this.scoreAudio,!1),this.fire_num+8-this.node.getChildren().length>1&&(this.fire_num-=1)},gameOver:function(){this.player.stopAllActions(),cc.director.loadScene("homepage")},jump:function(e){var t=this.player.getComponent("Player");e>this.max_powerup_time&&(e=this.max_powerup_time),t.YSpeed+=e*t.a,t.fall_state=!0,console.log(t.YSpeed)},setInputControl:function(){this.node.on("mousedown",function(e){console.log("Mouse down"),this.startTime=(new Date).getTime()},this),this.node.on("mouseup",function(e){var t=((new Date).getTime()-this.startTime)/1e3;console.log(t),this.jump(t)},this)}}),cc._RF.pop()},{test:"test"}],Player:[function(e,t,i){"use strict";cc._RF.push(t,"6c688v72QdOKamCGCT+xaAd","Player"),cc.Class({extends:cc.Component,properties:{jumpHeight:0,jumpDuration:0,maxMoveSpeed:0,accel:0,jumpAudio:{default:null,url:cc.AudioClip},YSpeed:20,g:50,a:50,fall_state:!0},playJumpSound:function(){cc.audioEngine.playEffect(this.jumpAudio,!1)},setInputControl:function(){var e=this;cc.eventManager.addListener({event:cc.EventListener.KEYBOARD,onKeyPressed:function(t,i){switch(t){case cc.KEY.a:e.accLeft=!0,e.accRight=!1;break;case cc.KEY.d:e.accLeft=!1,e.accRight=!0}},onKeyReleased:function(t,i){switch(t){case cc.KEY.a:e.accLeft=!1;break;case cc.KEY.d:e.accRight=!1}}},e.node)},onLoad:function(){console.log(this.node.getPosition().y),this.accLeft=!1,this.accRight=!1,this.xSpeed=0,this.setInputControl();var e=cc.director.getCollisionManager();e.enabled=!0,e.enabledDebugDraw=!0},onCollisionEnter:function(e,t){this.YSpeed=0;this.getComponent(cc.Animation).play("small");this.fall_state=!1},update:function(e){this.accLeft?this.xSpeed-=this.accel*e:this.accRight&&(this.xSpeed+=this.accel*e),Math.abs(this.xSpeed)>this.maxMoveSpeed&&(this.xSpeed=this.maxMoveSpeed*this.xSpeed/Math.abs(this.xSpeed)),this.node.x+=this.xSpeed*e,this.fall(e)},fall:function(e){this.node.getPosition().y>-87&&this.fall_state?this.YSpeed-=this.g*e:this.node.setPosition(cc.v2(this.node.getPosition().x,-87));var t=cc.moveBy(e,cc.p(0,this.YSpeed*e));this.node.runAction(t)}}),cc._RF.pop()},{}],PrefebTest:[function(e,t,i){"use strict";cc._RF.push(t,"c0d26BHLRZBNKC4t6r+RVlo","PrefebTest"),cc.Class({extends:cc.Component,properties:{},onLoad:function(){this.node.group="ground",console.log("testprefab");var e=cc.director.getCollisionManager();e.enabled=!0,e.enabledDebugDraw=!0,this.node.runAction(this.moveLeftAndRight())},start:function(){},update:function(e){},moveLeftAndRight:function(){var e=cc.moveBy(2,cc.p(-300,0)).easing(cc.easeCubicActionOut()),t=cc.moveBy(2,cc.p(300,0)).easing(cc.easeCubicActionOut());return cc.repeatForever(cc.sequence(e,t))}}),cc._RF.pop()},{}],Star:[function(e,t,i){"use strict";cc._RF.push(t,"4644f0m2WtABYRy+pn6dOaG","Star"),cc.Class({extends:cc.Component,properties:{pickRadius:0,game:{default:null,serializable:!1},XSpeed:2},onLoad:function(){},getPlayerDistance:function(){var e=this.game.player.getPosition();return cc.pDistance(this.node.position,e)},onPicked:function(){this.game.spawnNewStar(),this.game.gainScore(),this.node.destroy()},update:function(e){this.getPlayerDistance()<this.pickRadius?this.onPicked():(this.node.getPosition().x<-cc.winSize.width/2&&(console.log("new star"),this.game.spawnNewStar(),this.game.fire_num=this.game.fire_num+1,console.log(this.game.fire_num),this.node.destroy()),this.node.x-=this.XSpeed*e)}}),cc._RF.pop()},{}],music2:[function(e,t,i){"use strict";cc._RF.push(t,"e9d40TWNZBO74L7nPLhb6i+","music2"),cc.Class({extends:cc.Component,properties:{},start:function(){}}),cc._RF.pop()},{}],music:[function(e,t,i){"use strict";cc._RF.push(t,"981deg4VYJKir3+kQJRXVoG","music"),cc.Class({extends:cc.Component,properties:{audioSource:{type:cc.AudioSource,default:null}},play:function(){this.audioSource.play()},pause:function(){this.audioSource.pause()}}),cc._RF.pop()},{}],sceneChange:[function(e,t,i){"use strict";cc._RF.push(t,"28b8dxH5bhMhqpEtwkAWTiV","sceneChange"),cc.Class({extends:cc.Component,properties:{},toScene:function(){cc.director.loadScene("game")},start:function(){}}),cc._RF.pop()},{}],test:[function(e,t,i){"use strict";cc._RF.push(t,"ba700cot+ZB27i+awTDaxbv","test"),cc.Class({extends:cc.Component,properties:{YSpeed:0,g:50,a:50},onLoad:function(){var e=cc.director.getCollisionManager();e.enabled=!0,e.enabledDrawBoundingBox=!0,e.enabledDebugDraw=!0},start:function(){},update:function(e){this.fall(e)},onCollisionEnter:function(e,t){this.YSpeed=-this.YSpeed;var i=t.world;i.aabb,i.preAabb,i.transform,i.radius,i.position,i.points},fall:function(e){this.YSpeed-=this.g*e;var t=cc.moveBy(e,cc.p(0,this.YSpeed*e));this.node.runAction(t)}}),cc._RF.pop()},{}]},{},["Fire","Game","Player","PrefebTest","Star","music","music2","sceneChange","test"]);